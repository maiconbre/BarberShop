# ğŸ’ˆ BarberShop - Regras de Desenvolvimento Trae AI

## ğŸ¯ VisÃ£o Geral
Este arquivo define as regras e diretrizes para desenvolvimento no projeto BarberShop usando Trae AI, garantindo consistÃªncia arquitetural, aderÃªncia aos princÃ­pios SOLID e qualidade de cÃ³digo.

---

## ğŸ—ï¸ Arquitetura e Estrutura

### ğŸ“ Estrutura de DiretÃ³rios (OBRIGATÃ“RIA)
```
src/
â”œâ”€â”€ components/           # Componentes React organizados por responsabilidade
â”‚   â”œâ”€â”€ auth/            # AutenticaÃ§Ã£o (login, registro, recuperaÃ§Ã£o)
â”‚   â”œâ”€â”€ feature/         # Funcionalidades especÃ­ficas (agendamento, dashboard)
â”‚   â””â”€â”€ ui/              # Componentes reutilizÃ¡veis (botÃµes, modais, inputs)
â”œâ”€â”€ config/              # ConfiguraÃ§Ãµes do sistema
â”œâ”€â”€ contexts/            # Contextos React para estado compartilhado
â”œâ”€â”€ hooks/               # Hooks customizados reutilizÃ¡veis
â”œâ”€â”€ models/              # Modelos de domÃ­nio e entidades
â”œâ”€â”€ pages/               # PÃ¡ginas da aplicaÃ§Ã£o (rotas principais)
â”œâ”€â”€ services/            # Camada de serviÃ§os e APIs
â”‚   â”œâ”€â”€ cache/          # EstratÃ©gias de cache
â”‚   â”œâ”€â”€ interfaces/     # Contratos e abstraÃ§Ãµes
â”‚   â””â”€â”€ container/      # Dependency Injection (a implementar)
â”œâ”€â”€ stores/              # Estados globais (Zustand)
â”œâ”€â”€ types/               # DefiniÃ§Ãµes de tipos TypeScript
â”œâ”€â”€ utils/               # UtilitÃ¡rios e helpers
â””â”€â”€ validation/          # Schemas de validaÃ§Ã£o (Zod)
```

### ğŸš« Estrutura PROIBIDA
- NÃ£o criar pastas `shared/`, `common/` ou `misc/`
- NÃ£o misturar componentes de UI com lÃ³gica de negÃ³cio
- NÃ£o colocar tipos em arquivos de componentes
- NÃ£o criar arquivos `utils.ts` genÃ©ricos

---

## ğŸ§© PrincÃ­pios SOLID (OBRIGATÃ“RIOS)

### ğŸ¯ Single Responsibility Principle (SRP)
**REGRA**: Cada componente/funÃ§Ã£o deve ter UMA responsabilidade Ãºnica

```typescript
// âœ… CORRETO - Responsabilidade Ãºnica
interface ServiceListProps {
  services: Service[];
  onEdit: (service: Service) => void;
  onDelete: (id: string) => void;
}

// âŒ INCORRETO - MÃºltiplas responsabilidades
interface ServiceManagementProps {
  services: Service[];
  onEdit: (service: Service) => void;
  onDelete: (id: string) => void;
  onFilter: (filter: string) => void;
  onSort: (field: string) => void;
  onExport: () => void;
  onImport: (file: File) => void;
}
```

**LIMITE**: Componentes nÃ£o devem exceder 100 linhas
**AÃ‡ÃƒO**: Se exceder, quebrar em componentes menores

### ğŸ”“ Open/Closed Principle (OCP)
**REGRA**: Aberto para extensÃ£o, fechado para modificaÃ§Ã£o

```typescript
// âœ… CORRETO - ExtensÃ­vel via Strategy Pattern
interface ICacheStrategy {
  get(key: string): Promise<any>;
  set(key: string, value: any, ttl?: number): Promise<void>;
}

class MemoryCacheStrategy implements ICacheStrategy { /* ... */ }
class LocalStorageCacheStrategy implements ICacheStrategy { /* ... */ }
```

### ğŸ”„ Liskov Substitution Principle (LSP)
**REGRA**: Subtipos devem ser substituÃ­veis por seus tipos base

```typescript
// âœ… CORRETO - ImplementaÃ§Ãµes intercambiÃ¡veis
interface IApiService {
  get<T>(endpoint: string): Promise<ApiResponse<T>>;
}

class AxiosApiService implements IApiService { /* ... */ }
class FetchApiService implements IApiService { /* ... */ }
```

### ğŸ”§ Interface Segregation Principle (ISP)
**REGRA**: Interfaces especÃ­ficas sÃ£o melhores que interfaces gerais

```typescript
// âœ… CORRETO - Interfaces especÃ­ficas
interface IReadable { read(): Promise<any>; }
interface IWritable { write(data: any): Promise<void>; }
interface ICacheable { cache(key: string, data: any): Promise<void>; }

// âŒ INCORRETO - Interface muito ampla
interface IDataService {
  read(): Promise<any>;
  write(data: any): Promise<void>;
  cache(key: string, data: any): Promise<void>;
  validate(data: any): boolean;
  transform(data: any): any;
}
```

### ğŸ”€ Dependency Inversion Principle (DIP)
**REGRA**: Depender de abstraÃ§Ãµes, nÃ£o de implementaÃ§Ãµes concretas

```typescript
// âœ… CORRETO - Depende de abstraÃ§Ã£o
class AppointmentService {
  constructor(private apiService: IApiService) {}
}

// âŒ INCORRETO - Depende de implementaÃ§Ã£o concreta
class AppointmentService {
  constructor(private apiService: AxiosApiService) {}
}
```

---

## ğŸ“ PadrÃµes de CÃ³digo

### ğŸ¨ Componentes React

**ESTRUTURA OBRIGATÃ“RIA**:
```typescript
// 1. Imports (externos primeiro, internos depois)
import React from 'react';
import { motion } from 'framer-motion';
import { Button } from '@/components/ui';
import { useAppointments } from '@/hooks';

// 2. Interface/Types
interface ComponentProps {
  title: string;
  onAction?: () => void;
}

// 3. Componente
export const Component: React.FC<ComponentProps> = ({ title, onAction }) => {
  // 4. Hooks no topo
  const { data, loading } = useAppointments();
  
  // 5. Handlers
  const handleClick = () => {
    onAction?.();
  };
  
  // 6. Early returns
  if (loading) return <div>Loading...</div>;
  
  // 7. JSX
  return (
    <motion.div className="p-4">
      <h2>{title}</h2>
      <Button onClick={handleClick}>Action</Button>
    </motion.div>
  );
};
```

### ğŸ£ Hooks Customizados

**PADRÃƒO OBRIGATÃ“RIO**:
```typescript
export const useFeature = (id: string) => {
  const [data, setData] = useState<DataType | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  
  // Sempre retornar objeto com propriedades nomeadas
  return { data, loading, error, refetch };
};
```

### ğŸ—ƒï¸ Stores Zustand

**ESTRUTURA OBRIGATÃ“RIA**:
```typescript
interface StoreState {
  // Estado
  data: DataType[];
  loading: boolean;
  error: string | null;
  
  // AÃ§Ãµes
  fetchData: () => Promise<void>;
  addItem: (item: DataType) => void;
  updateItem: (id: string, updates: Partial<DataType>) => void;
  removeItem: (id: string) => void;
  clearError: () => void;
}

export const useStore = create<StoreState>()()
  persist(
    (set, get) => ({
      // Estado inicial
      data: [],
      loading: false,
      error: null,
      
      // ImplementaÃ§Ãµes
      fetchData: async () => { /* ... */ },
      // ...
    }),
    {
      name: 'store-name',
      partialize: (state) => ({ data: state.data })
    }
  )
);
```

---

## ğŸ§ª Testes (OBRIGATÃ“RIOS)

### ğŸ“‹ Cobertura MÃ­nima
- **Componentes**: 80% de cobertura
- **Hooks**: 90% de cobertura
- **Services**: 95% de cobertura
- **Utils**: 100% de cobertura

### ğŸ—ï¸ Estrutura de Testes
```typescript
// src/components/feature/__tests__/Component.test.tsx
import { render, screen, fireEvent } from '@testing-library/react';
import { Component } from '../Component';

describe('Component', () => {
  it('should render correctly', () => {
    render(<Component title="Test" />);
    expect(screen.getByText('Test')).toBeInTheDocument();
  });
  
  it('should handle user interactions', () => {
    const onAction = jest.fn();
    render(<Component title="Test" onAction={onAction} />);
    
    fireEvent.click(screen.getByRole('button'));
    expect(onAction).toHaveBeenCalled();
  });
});
```

---

## ğŸ›¡ï¸ Error Boundaries (IMPLEMENTAR)

### ğŸ“ LocalizaÃ§Ã£o ObrigatÃ³ria
- `src/components/error/ErrorBoundary.tsx` (genÃ©rico)
- `src/components/error/AsyncErrorBoundary.tsx` (async)
- `src/components/error/RouteErrorBoundary.tsx` (rotas)
- `src/components/error/FormErrorBoundary.tsx` (formulÃ¡rios)

### ğŸ¯ Uso ObrigatÃ³rio
```typescript
// Envolver componentes crÃ­ticos
<ErrorBoundary fallback={<ErrorFallback />}>
  <CriticalComponent />
</ErrorBoundary>
```

---

## ğŸ”§ Dependency Injection (IMPLEMENTAR)

### ğŸ“ Container DI
```typescript
// src/services/container/DIContainer.ts
class DIContainer {
  private services = new Map<string, any>();
  
  register<T>(token: string, implementation: T): void;
  resolve<T>(token: string): T;
  singleton<T>(token: string, factory: () => T): void;
}

// Uso
container.register('IApiService', new AxiosApiService());
const apiService = container.resolve<IApiService>('IApiService');
```

---

## ğŸ“ MÃ©tricas de Qualidade

### ğŸ¯ Limites ObrigatÃ³rios
- **Componentes**: MÃ¡ximo 100 linhas
- **Hooks**: MÃ¡ximo 50 linhas
- **FunÃ§Ãµes**: MÃ¡ximo 20 linhas
- **Complexidade CiclomÃ¡tica**: MÃ¡ximo 10
- **Acoplamento**: MÃ¡ximo 5 dependÃªncias por mÃ³dulo

### ğŸ“Š Performance
- **Bundle Size**: MÃ¡ximo 500KB (gzipped)
- **First Contentful Paint**: < 1.5s
- **Time to Interactive**: < 3s
- **API Response**: < 200ms

---

## ğŸš« PrÃ¡ticas PROIBIDAS

### âŒ CÃ³digo
- `any` type (usar `unknown` se necessÃ¡rio)
- `console.log` em produÃ§Ã£o (usar logger)
- MutaÃ§Ã£o direta de estado
- Componentes sem TypeScript
- Imports relativos profundos (`../../../`)

### âŒ Estrutura
- Arquivos com mais de 200 linhas
- Componentes com mÃºltiplas responsabilidades
- Services acoplados a implementaÃ§Ãµes concretas
- Estado global desnecessÃ¡rio

### âŒ Performance
- Re-renders desnecessÃ¡rios
- Fetch de dados em componentes
- Imagens nÃ£o otimizadas
- Bundle splitting inadequado

---

## âœ… Checklist de Desenvolvimento

### ğŸ” Antes de Commit
- [ ] CÃ³digo segue princÃ­pios SOLID
- [ ] Componentes < 100 linhas
- [ ] Testes implementados e passando
- [ ] TypeScript sem erros
- [ ] ESLint sem warnings
- [ ] Performance validada
- [ ] DocumentaÃ§Ã£o atualizada

### ğŸš€ Antes de Deploy
- [ ] Build sem erros
- [ ] Testes E2E passando
- [ ] Bundle size dentro do limite
- [ ] Lighthouse score > 90
- [ ] Error boundaries testados
- [ ] Logs configurados

---

## ğŸ¯ Roadmap de ImplementaÃ§Ã£o

### ğŸ”¥ Prioridade ALTA (2-4 semanas)
1. **Error Boundaries** - Implementar em todos os componentes crÃ­ticos
2. **AbstraÃ§Ãµes ApiService** - Criar interfaces e DI container
3. **RefatoraÃ§Ã£o de Componentes** - Quebrar componentes grandes
4. **Testes BÃ¡sicos** - Cobertura mÃ­nima de 70%

### ğŸš€ Prioridade MÃ‰DIA (1-2 meses)
5. **Container DI Completo** - InversÃ£o total de dependÃªncias
6. **Factory Patterns** - Para criaÃ§Ã£o de objetos complexos
7. **Strategy Patterns** - Para algoritmos intercambiÃ¡veis
8. **Interface Segregation** - Refinamento de contratos

### ğŸŒŸ Prioridade BAIXA (3+ meses)
9. **Micro-frontends** - Arquitetura modular
10. **GraphQL** - API mais eficiente
11. **SSR** - Server-Side Rendering

---

## ğŸ“š Recursos e ReferÃªncias

### ğŸ”— Links Ãšteis
- [SOLID Principles](https://en.wikipedia.org/wiki/SOLID)
- [React Testing Library](https://testing-library.com/docs/react-testing-library/intro/)
- [Zustand Documentation](https://github.com/pmndrs/zustand)
- [Zod Validation](https://github.com/colinhacks/zod)

### ğŸ“– DocumentaÃ§Ã£o Interna
- `README.md` - VisÃ£o geral do projeto
- `Upgrade/ALTA.md` - Roadmap detalhado
- `Upgrade/roadmap.solid.md` - Prioridades SOLID

---

**ğŸ¯ Objetivo**: Manter 100% de aderÃªncia aos princÃ­pios SOLID e garantir cÃ³digo limpo, testÃ¡vel e manutenÃ­vel em todas as implementaÃ§Ãµes.**